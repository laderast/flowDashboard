<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>flowDashboard Vignette â€¢ flowDashboard</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">flowDashboard</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flowDashboard.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gvhdVignette.html">Transforming the GvHD set into flowDashboard Objects</a>
    </li>
    <li>
      <a href="../articles/R6flow.html">Building, Modifying, and Using flowDashboard R6 Objects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>flowDashboard Vignette</h1>
                        <h4 class="author">Ted Laderas</h4>
            
            <h4 class="date">2017-12-19</h4>
          </div>

    
    
<div class="contents">
<p>This document outlines how to set up a flow cytometry dashboard using the <code>flowDashboard</code> Shiny modules.</p>
<div id="where-flowdashboard-fits-in-an-analysis-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#where-flowdashboard-fits-in-an-analysis-workflow" class="anchor"></a>Where <code>flowDashboard</code> Fits in an Analysis Workflow</h2>
<p><code>flowDashboard</code> enables you to visualize data at both the Sample and Population Level. The package assumes that you either have FCS data in a directory, or have generated a GatingSet for your gating scheme. This gating scheme can either be automated (from a pipeline such as <code>openCyto</code>) or manually (imported from flowJo).</p>
<p>There are multiple modules that will enable you to examine each step of the analysis.</p>
<ul>
<li>
<code>Annotation</code> display - displays annotation for all the FCS files in an experiment.</li>
<li>
<code>QC</code> plots - plots that let you compare the overall state of the data before and after preprocessing.</li>
<li>
<code>Gating</code> plots - plots that display how the data was gated</li>
<li>
<code>Dot</code> plots - to visualize populations based on a covariate</li>
<li>
<code>Violin</code> plots of markers in a population</li>
<li>
<code>Waterfall</code> plots to examine how population percentage correlates with an outcome.</li>
<li>
<code>Coexpression</code> plots - a heatmap and a two-way expression explorer.</li>
</ul>
</div>
<div id="preprocessing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-data" class="anchor"></a>Preprocessing Data</h2>
<p>Once your data is in a <code>gatingSet</code> (preferably in ncdf format), we will need to transform and prep it into the <code>data.table</code> format. This package uses <code>data.table</code> because it is a very fast format for accessing, merging, sorting, and displaying data.</p>
<p>The annotation structure is another <code>data.table</code> that we need for the dashboard. Based on your unit of analysis and what the FCS file represents (which may be patients, cell lines, or conditions within a patient), you will need an annotation table that provides covariate information at the level of analysis you are interested in. You can generate the skeleton of an annotation table with the `` command, or you can use the phenoData slot in your GatingSet.</p>
<p>Please note that the usefulness of <code>flowDashboard</code> is only as good as your annotation. Careful curation of variables in your annotation will allow you to sort, subset, and aggregate on these variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(flowWorkspace)</code></pre></div>
<pre><code>## Loading required package: flowCore</code></pre>
<pre><code>## Loading required package: ncdfFlow</code></pre>
<pre><code>## Loading required package: RcppArmadillo</code></pre>
<pre><code>## Loading required package: BH</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(flowDashboard)</code></pre></div>
<pre><code>## Loading required package: tidyr</code></pre>
<pre><code>## Loading required package: dplyr</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following object is masked from 'package:ncdfFlow':
## 
##     filter</code></pre>
<pre><code>## The following object is masked from 'package:flowCore':
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Loading required package: shiny</code></pre>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     between, first, last</code></pre>
<pre><code>## Loading required package: dtplyr</code></pre>
<pre><code>## Loading required package: ggvis</code></pre>
<pre><code>## Loading required package: lazyeval</code></pre>
<pre><code>## Loading required package: gplots</code></pre>
<pre><code>## 
## Attaching package: 'gplots'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     lowess</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## 
## Attaching package: 'ggplot2'</code></pre>
<pre><code>## The following object is masked from 'package:ggvis':
## 
##     resolution</code></pre>
<pre><code>## Loading required package: R6</code></pre>
<pre><code>## Loading required package: forcats</code></pre>
<pre><code>## Loading required package: stringi</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gsFile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/gvHDgs/"</span>, <span class="dt">package =</span> <span class="st">"flowDashboard"</span>)
gs &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/flowWorkspace/topics/save_gs">load_gs</a></span>(gsFile)</code></pre></div>
<pre><code>## loading R object...</code></pre>
<pre><code>## loading tree object...</code></pre>
<pre><code>## Done</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##look at phenoData slot in gs
phenotypes &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/flowWorkspace/topics/pData-methods">pData</a></span>(gs<span class="op">@</span>data<span class="op">@</span>phenoData)
phenotypes</code></pre></div>
<pre><code>##       Patient Visit Days Grade  name
## s5a01       5     1   -6     3 s5a01
## s5a02       5     2    0     3 s5a02
## s5a03       5     3    6     3 s5a03
## s5a04       5     4   12     3 s5a04
## s5a05       5     5   19     3 s5a05
## s5a06       5     6   26     3 s5a06
## s5a07       5     7   33     3 s5a07
## s6a01       6     1   -8     3 s6a01
## s6a02       6     2    0     3 s6a02
## s6a03       6     3    5     3 s6a03
## s6a04       6     4   12     3 s6a04
## s6a05       6     5   19     3 s6a05
## s6a06       6     6   27     3 s6a06
## s6a07       6     7   32     3 s6a07
## s7a01       7     1   -4     3 s7a01
## s7a02       7     2    0     3 s7a02
## s7a03       7     3    7     3 s7a03
## s7a04       7     4   14     3 s7a04
## s7a05       7     5   21     3 s7a05
## s7a06       7     6   28     3 s7a06</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##look at marker information in gs
markerInfo &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/flowWorkspace/topics/pData-methods">pData</a></span>(<span class="kw">parameters</span>(gs<span class="op">@</span>data[[<span class="dv">1</span>]]))
markerInfo</code></pre></div>
<pre><code>##      name              desc range  minRange     maxRange
## $P1 FSC-H        FSC-Height  1024 0.0000000  1023.000000
## $P2 SSC-H        SSC-Height  1024 0.0000000  1023.000000
## $P3 FL1-H         CD15 FITC  1024 0.8813736     9.903488
## $P4 FL2-H           CD45 PE  1024 0.8813736     9.903488
## $P5 FL3-H        CD14 PerCP  1024 0.8813736     9.903488
## $P6 FL2-A              &lt;NA&gt;  1024 0.0000000     7.623642
## $P7 FL4-H          CD33 APC  1024 1.0000000 10000.000000
## $P8  Time Time (51.20 sec.)  1024 0.0000000  1023.000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#build a qcFlowObj </span>
QCO &lt;-<span class="st"> </span><span class="kw"><a href="../reference/QCOFromGatingSet.html">QCOFromGatingSet</a></span>(gs, <span class="dt">samplePop =</span> <span class="dv">1000</span>)

<span class="co">#show annotation slot</span>
QCO<span class="op">$</span>annotation</code></pre></div>
<pre><code>##     Patient Visit Days Grade  name
##  1:       5     1   -6     3 s5a01
##  2:       5     2    0     3 s5a02
##  3:       5     3    6     3 s5a03
##  4:       5     4   12     3 s5a04
##  5:       5     5   19     3 s5a05
##  6:       5     6   26     3 s5a06
##  7:       5     7   33     3 s5a07
##  8:       6     1   -8     3 s6a01
##  9:       6     2    0     3 s6a02
## 10:       6     3    5     3 s6a03
## 11:       6     4   12     3 s6a04
## 12:       6     5   19     3 s6a05
## 13:       6     6   27     3 s6a06
## 14:       6     7   32     3 s6a07
## 15:       7     1   -4     3 s7a01
## 16:       7     2    0     3 s7a02
## 17:       7     3    7     3 s7a03
## 18:       7     4   14     3 s7a04
## 19:       7     5   21     3 s7a05
## 20:       7     6   28     3 s7a06</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#show first few lines of qcData</span>
QCO<span class="op">$</span>qcData</code></pre></div>
<pre><code>##         idVar cellNum          variable value
##      1: s5a01    1560        FSC.Height   812
##      2: s5a01    2999        FSC.Height   164
##      3: s5a01    1825        FSC.Height   256
##      4: s5a01     811        FSC.Height    79
##      5: s5a01    1275        FSC.Height   218
##     ---                                      
## 159996: s7a06   10589 Time..51.20.sec..    79
## 159997: s7a06    3426 Time..51.20.sec..    26
## 159998: s7a06    6128 Time..51.20.sec..    46
## 159999: s7a06    8299 Time..51.20.sec..    61
## 160000: s7a06    5875 Time..51.20.sec..    43</code></pre>
</div>
<div id="qc-module" class="section level2">
<h2 class="hasAnchor">
<a href="#qc-module" class="anchor"></a>QC Module</h2>
<p>The QC Heatmap provides a quick overview of how markers vary across populations. This heatmap is based on the idea of examining a QC panel of markers to compare whether there is a large technical variation between samples.</p>
<p>The QC Violin plots allow you to compare fluoresence distibution of individual functions.</p>
<p>The underlying QC data is sampled using the <code><a href="../reference/buildSampledDataList.html">buildSampledDataList()</a></code> function. This function generates a data.table that samples from each FCS file for a selected control panel of markers.</p>
</div>
<div id="gating-module" class="section level2">
<h2 class="hasAnchor">
<a href="#gating-module" class="anchor"></a>Gating Module</h2>
<p>The gating module consists of a heatmap visualization and plots for each cell in the heatmap, corresponding to the gating scheme. This module is useful in understanding the impact of automated gating pipelines, such as <code>openCyto</code>, and comparing manual gating schemes across samples.</p>
<p>The plots for each sample must be precomputed using the <code><a href="../reference/plotAllPopulations.html">plotAllPopulations()</a></code> function. This function takes a GatingSet as input.</p>
<p>The Violin plots</p>
</div>
<div id="coexpression-module" class="section level2">
<h2 class="hasAnchor">
<a href="#coexpression-module" class="anchor"></a>Coexpression Module</h2>
</div>
<div id="waterfall-module" class="section level2">
<h2 class="hasAnchor">
<a href="#waterfall-module" class="anchor"></a>Waterfall Module</h2>
<p>This module displays population percentages</p>
</div>
<div id="dotplot-module" class="section level2">
<h2 class="hasAnchor">
<a href="#dotplot-module" class="anchor"></a>DotPlot Module</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#where-flowdashboard-fits-in-an-analysis-workflow">Where <code>flowDashboard</code> Fits in an Analysis Workflow</a></li>
      <li><a href="#preprocessing-data">Preprocessing Data</a></li>
      <li><a href="#qc-module">QC Module</a></li>
      <li><a href="#gating-module">Gating Module</a></li>
      <li><a href="#coexpression-module">Coexpression Module</a></li>
      <li><a href="#waterfall-module">Waterfall Module</a></li>
      <li><a href="#dotplot-module">DotPlot Module</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ted Laderas G..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
