<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transforming the GvHD set into flowDashboard Objects • flowDashboard</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">flowDashboard</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flowDashboard.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gvhdVignette.html">Transforming the GvHD set into flowDashboard Objects</a>
    </li>
    <li>
      <a href="../articles/R6flow.html">Building, Modifying, and Using flowDashboard R6 Objects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Transforming the GvHD set into flowDashboard Objects</h1>
                        <h4 class="author">Ted Laderas</h4>
            
            <h4 class="date">8/4/2017</h4>
          </div>

    
    
<div class="contents">
<div id="creating-a-gatingset-from-gvhd-data" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-gatingset-from-gvhd-data" class="anchor"></a>Creating a GatingSet from GvHD Data</h2>
<p>This code was taken from the <code>flowWorkspace</code> documentation. Note that we take the incoming flowSet and convert it to a ncdfFlowSet. In general, we find this file format is more stable, especially when generating plots</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## This code was modified from flowWorkspace examples
<span class="kw">library</span>(flowStats)
<span class="kw">data</span>(GvHD)
<span class="co">#select raw flow data and cast as ncdfFlowSet</span>
fs&lt;-<span class="kw">ncdfFlowSet</span>(GvHD[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>])

<span class="kw">pData</span>(fs)<span class="op">$</span>Visit &lt;-<span class="st"> </span><span class="kw">ordered</span>(<span class="kw">pData</span>(fs)<span class="op">$</span>Visit)
<span class="kw">pData</span>(fs)<span class="op">$</span>Days &lt;-<span class="st"> </span><span class="kw">ordered</span>(<span class="kw">pData</span>(fs)<span class="op">$</span>Days)

<span class="co">#transform the raw data</span>
tf &lt;-<span class="st"> </span><span class="kw">transformList</span>(<span class="kw">colnames</span>(fs[[<span class="dv">1</span>]])[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>], asinh, <span class="dt">transformationId=</span><span class="st">"asinh"</span>)
fs_trans&lt;-<span class="kw">transform</span>(fs,tf)
<span class="co">#add transformed data to a GatingSet</span>
gs &lt;-<span class="st"> </span><span class="kw">GatingSet</span>(fs_trans)
gs</code></pre></div>
<pre><code>## A GatingSet with 20 samples</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getNodes</span>(gs[[<span class="dv">1</span>]]) <span class="co">#only contains root node</span></code></pre></div>
<pre><code>## [1] "root"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#add one gate</span>
rg &lt;-<span class="st"> </span><span class="kw">rectangleGate</span>(<span class="st">"FSC-H"</span>=<span class="kw">c</span>(<span class="dv">200</span>,<span class="dv">400</span>), <span class="st">"SSC-H"</span>=<span class="kw">c</span>(<span class="dv">250</span>, <span class="dv">400</span>),
                    <span class="dt">filterId=</span><span class="st">"rectangle"</span>)
nodeID&lt;-<span class="kw">add</span>(gs, rg)<span class="co">#it is added to root node by default if parent is not specified</span>
nodeID</code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getNodes</span>(gs[[<span class="dv">1</span>]]) <span class="co">#the second population is named after filterId of the gate</span></code></pre></div>
<pre><code>## [1] "root"       "/rectangle"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#add a quadGate</span>
qg &lt;-<span class="st"> </span><span class="kw">quadGate</span>(<span class="st">"FL1-H"</span>=<span class="dv">2</span>, <span class="st">"FL2-H"</span>=<span class="dv">4</span>)
nodeIDs&lt;-<span class="kw">add</span>(gs,qg,<span class="dt">parent=</span><span class="st">"rectangle"</span>)
nodeIDs <span class="co">#quadGate produces four population nodes</span></code></pre></div>
<pre><code>## [1] 3 4 5 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getNodes</span>(gs[[<span class="dv">1</span>]]) <span class="co">#population names are named after dimensions of gate if not specified</span></code></pre></div>
<pre><code>## [1] "root"                          "/rectangle"                   
## [3] "/rectangle/CD15 FITC-CD45 PE+" "/rectangle/CD15 FITC+CD45 PE+"
## [5] "/rectangle/CD15 FITC+CD45 PE-" "/rectangle/CD15 FITC-CD45 PE-"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#do the actual gating</span>
<span class="kw">recompute</span>(gs)



<span class="co">#dir &lt;- paste0(tempdir(),"/gs")</span>
<span class="co">#create.dir(dir)</span>

<span class="co">#save_gs(dir)</span></code></pre></div>
</div>
<div id="building-data-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#building-data-objects" class="anchor"></a>Building Data Objects</h2>
<p>Now that the <code>GvHD</code> data is gated and in a <code>GatingSet</code>, we can build the various objects. First we look at the markers and pick three markers as markers for general QC. In this example, annotation is derived from the <code>phenoData</code> slot of <code>gs@data</code>. Here, we sample our data, in order to save memory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#load_gs(dir)</span>
<span class="co">#show annotation</span>
pD &lt;-<span class="st"> </span><span class="kw">pData</span>(gs<span class="op">@</span>data<span class="op">@</span>phenoData)
qcMarkers &lt;-<span class="st"> </span>pD<span class="op">$</span>desc[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]

<span class="co">#show first three markers</span>
qcMarkers</code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(flowDashboard)
##build QCO object
QCO &lt;-<span class="st"> </span><span class="kw"><a href="../reference/QCOFromGatingSet.html">QCOFromGatingSet</a></span>(gs,<span class="dt">samplePop =</span> <span class="dv">1000</span>, <span class="dt">qcMarkers =</span> qcMarkers)
##show structure of qcFlowObj
QCO</code></pre></div>
<pre><code>## &lt;qcFlowObj&gt;
##   Inherits from: &lt;commonDataObj&gt;
##   Public:
##     annotation: data.table, data.frame
##     annotCols: Patient Visit Days Grade
##     checkIntegrity: function (reconcile = FALSE) 
##     clone: function (deep = FALSE) 
##     contextID: NULL
##     initialize: function (annotation, qcData, mapVar = NULL, checkIntegrity = TRUE, 
##     mapVar: name
##     markers: FSC.Height SSC.Height CD15.FITC CD45.PE CD14.PerCP NA. C ...
##     objId: QCO-XHGMZ85
##     qcData: data.table, data.frame
##     returnMergedData: function () 
##     setAnnotationDisplayOptions: function (annotCols) 
##     setMarkers: function (markers) 
##     setSubsetAndSortOptions: function (subsetOptions, sortOptions, checkIntegrity = TRUE) 
##     sortOptionList: NULL
##     sortOptions: Patient Visit Days Grade
##     subsetAnnotation: function (ids) 
##     subsetOptionList: list
##     subsetOptions: Patient Visit Days Grade</code></pre>
<p>Things to notice: <code>QCO</code> has three main slots: <code>QCO$qcData</code>, which holds the expression data, <code>QCO$annotation</code>, which holds the annotation, and <code>QCO$mapVar</code>, which is the key mapping <code>QCO$annotation</code> into <code>QCO$data</code>.</p>
<p>Additionally, there are multiple methods that alter display options. Once these are set, the UI elements are generated automatically from the object.</p>
<p>-<code>QCO$setAnnotationDisplayOptions()</code> - this controls what annotation columns to display (supplied as a vector of column names) in the hover tooltip when you mouse over the heatmap. This method checks to see that the column names supplied exist within <code>QCO$annotation</code>. -<code>QCO$setSubsetAndSortOptions()</code> - this controls what columns to subset on and sort on (supplied as a vector of column names) in the subset module. This also checks to see that the column names exist in <code>QCO$annotation</code>.</p>
<p>Note that <code>QCO</code> has a slot called <code>objId</code>. This is the identifier used when using <code>QCO</code> in one of <code>flowDashboard</code>’s shiny modules. Having unique identfiers for each object helps to avoid namespace collisions in the shiny option. By default, the identifer is randomly generated, though the user can override the default, either by specifying <code>objId</code> as an argument in the <code>QCOfromGatingSet()</code> function, or when invoking the modules separately. This <code>objId</code> lets the <code>flowDashboard</code> modules work together, or work separately (more on that later).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">QCO<span class="op">$</span>objId</code></pre></div>
<pre><code>## [1] "QCO-XHGMZ85"</code></pre>
<p>If we use the <code>returnMergedData()</code> method, we can see the underlying merged data/annotation. We keep these two <code>data.table</code>s separate in order to save space (avoiding redundant information), and because different display methods require either the annotation or the underlying data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(QCO<span class="op">$</span><span class="kw">returnMergedData</span>()[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,])</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">idVar</th>
<th align="right">cellNum</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="left">Patient</th>
<th align="left">Visit</th>
<th align="left">Days</th>
<th align="right">Grade</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">3186</td>
<td align="left">FSC.Height</td>
<td align="right">595</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">411</td>
<td align="left">FSC.Height</td>
<td align="right">96</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">3129</td>
<td align="left">FSC.Height</td>
<td align="right">100</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">569</td>
<td align="left">FSC.Height</td>
<td align="right">453</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">70</td>
<td align="left">FSC.Height</td>
<td align="right">232</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">1402</td>
<td align="left">FSC.Height</td>
<td align="right">90</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">786</td>
<td align="left">FSC.Height</td>
<td align="right">70</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">664</td>
<td align="left">FSC.Height</td>
<td align="right">229</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">3042</td>
<td align="left">FSC.Height</td>
<td align="right">160</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">3007</td>
<td align="left">FSC.Height</td>
<td align="right">91</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">3024</td>
<td align="left">FSC.Height</td>
<td align="right">166</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">2068</td>
<td align="left">FSC.Height</td>
<td align="right">346</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">316</td>
<td align="left">FSC.Height</td>
<td align="right">65</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="right">1177</td>
<td align="left">FSC.Height</td>
<td align="right">80</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="right">1557</td>
<td align="left">FSC.Height</td>
<td align="right">183</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Here we build the <code>gatingObj</code> from the <code>GatingSet</code>. We can also create all of the relevant gating plots by setting <code>makeGraphs</code> to <code>TRUE</code>. Note that if you have a lot of samples and a lot of gates, the plotting can take a while.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GO &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GOFromGatingSet.html">GOFromGatingSet</a></span>(gs,<span class="dt">imageDir =</span> <span class="st">"../sampleDashboard/data/gating/"</span>, <span class="dt">makeGraphs =</span> <span class="ot">FALSE</span>)
<span class="co">#GO &lt;- GOFromGatingSet(gs,imageDir = "../sampleDashboard/data/gating/", makeGraphs = TRUE)</span>
##show structure of gatingObj
GO</code></pre></div>
<pre><code>## &lt;gatingObj&gt;
##   Inherits from: &lt;commonDataObj&gt;
##   Public:
##     annotation: data.table, data.frame
##     annotCols: name Patient Visit Days Grade Population Count
##     checkIntegrity: function (reconcile = FALSE) 
##     clone: function (deep = FALSE) 
##     contextID: NULL
##     gates: NULL
##     imageDir: ../sampleDashboard/data/gating/
##     initialize: function (annotation, popTable, mapVar = NULL, gates = NULL, 
##     mapVar: name
##     objId: GO-QCEUS35
##     popSubsets: list
##     popTable: data.table, data.frame
##     populations: rectangle CD15 FITC-CD45 PE+ CD15 FITC+CD45 PE+ CD15 FIT ...
##     returnMergedData: function () 
##     setAnnotationDisplayOptions: function (annotCols) 
##     setPopulations: function (popList) 
##     setPopulationSubset: function (subPopSets = NULL) 
##     setSubsetAndSortOptions: function (subsetOptions, sortOptions, checkIntegrity = TRUE) 
##     sortOptionList: NULL
##     sortOptions: Patient Visit Days Grade
##     subsetAnnotation: function (ids) 
##     subsetOptionList: list
##     subsetOptions: Patient Visit Days Grade</code></pre>
<p>Again, we can see the merged data table from <code>GO</code> by using <code>returnMergedData()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(GO<span class="op">$</span><span class="kw">returnMergedData</span>()[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,])</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">Population</th>
<th align="left">Parent</th>
<th align="right">Count</th>
<th align="right">ParentCount</th>
<th align="left">idVar</th>
<th align="right">percentPop</th>
<th align="right">zscore</th>
<th align="left">popKey</th>
<th align="left">Patient</th>
<th align="left">Visit</th>
<th align="left">Days</th>
<th align="right">Grade</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">s5a01</td>
<td align="left">rectangle</td>
<td align="left">root</td>
<td align="right">97</td>
<td align="right">3420</td>
<td align="left">s5a01+rectangle+GO-QCEUS35</td>
<td align="right">2.8362573</td>
<td align="right">0.1001221</td>
<td align="left">s5a01+rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="left">CD15 FITC-CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">0</td>
<td align="right">97</td>
<td align="left">s5a01+CD15 FITCnegCD45 PEpos+GO-QCEUS35</td>
<td align="right">0.0000000</td>
<td align="right">-0.4411082</td>
<td align="left">s5a01+CD15 FITC-CD45 PE+</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="left">CD15 FITC+CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">89</td>
<td align="right">97</td>
<td align="left">s5a01+CD15 FITCposCD45 PEpos+GO-QCEUS35</td>
<td align="right">91.7525773</td>
<td align="right">0.0585577</td>
<td align="left">s5a01+CD15 FITC+CD45 PE+</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a01</td>
<td align="left">CD15 FITC+CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">6</td>
<td align="right">97</td>
<td align="left">s5a01+CD15 FITCposCD45 PEneg+GO-QCEUS35</td>
<td align="right">6.1855670</td>
<td align="right">1.3761503</td>
<td align="left">s5a01+CD15 FITC+CD45 PE-</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a01</td>
<td align="left">CD15 FITC-CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">2</td>
<td align="right">97</td>
<td align="left">s5a01+CD15 FITCnegCD45 PEneg+GO-QCEUS35</td>
<td align="right">2.0618557</td>
<td align="right">-0.2443595</td>
<td align="left">s5a01+CD15 FITC-CD45 PE-</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a02</td>
<td align="left">rectangle</td>
<td align="left">root</td>
<td align="right">54</td>
<td align="right">3405</td>
<td align="left">s5a02+rectangle+GO-QCEUS35</td>
<td align="right">1.5859031</td>
<td align="right">-0.2834748</td>
<td align="left">s5a02+rectangle</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a02</td>
<td align="left">CD15 FITC-CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">0</td>
<td align="right">54</td>
<td align="left">s5a02+CD15 FITCnegCD45 PEpos+GO-QCEUS35</td>
<td align="right">0.0000000</td>
<td align="right">-0.4411082</td>
<td align="left">s5a02+CD15 FITC-CD45 PE+</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a02</td>
<td align="left">CD15 FITC+CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">46</td>
<td align="right">54</td>
<td align="left">s5a02+CD15 FITCposCD45 PEpos+GO-QCEUS35</td>
<td align="right">85.1851852</td>
<td align="right">-0.3323285</td>
<td align="left">s5a02+CD15 FITC+CD45 PE+</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a02</td>
<td align="left">CD15 FITC+CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">1</td>
<td align="right">54</td>
<td align="left">s5a02+CD15 FITCposCD45 PEneg+GO-QCEUS35</td>
<td align="right">1.8518519</td>
<td align="right">-0.1685001</td>
<td align="left">s5a02+CD15 FITC+CD45 PE-</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a02</td>
<td align="left">CD15 FITC-CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">7</td>
<td align="right">54</td>
<td align="left">s5a02+CD15 FITCnegCD45 PEneg+GO-QCEUS35</td>
<td align="right">12.9629630</td>
<td align="right">0.4722496</td>
<td align="left">s5a02+CD15 FITC-CD45 PE-</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a03</td>
<td align="left">rectangle</td>
<td align="left">root</td>
<td align="right">11</td>
<td align="right">3435</td>
<td align="left">s5a03+rectangle+GO-QCEUS35</td>
<td align="right">0.3202329</td>
<td align="right">-0.6717704</td>
<td align="left">s5a03+rectangle</td>
<td align="left">5</td>
<td align="left">3</td>
<td align="left">6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a03</td>
<td align="left">CD15 FITC-CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="left">s5a03+CD15 FITCnegCD45 PEpos+GO-QCEUS35</td>
<td align="right">0.0000000</td>
<td align="right">-0.4411082</td>
<td align="left">s5a03+CD15 FITC-CD45 PE+</td>
<td align="left">5</td>
<td align="left">3</td>
<td align="left">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a03</td>
<td align="left">CD15 FITC+CD45 PE+</td>
<td align="left">rectangle</td>
<td align="right">7</td>
<td align="right">11</td>
<td align="left">s5a03+CD15 FITCposCD45 PEpos+GO-QCEUS35</td>
<td align="right">63.6363636</td>
<td align="right">-1.6148983</td>
<td align="left">s5a03+CD15 FITC+CD45 PE+</td>
<td align="left">5</td>
<td align="left">3</td>
<td align="left">6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">s5a03</td>
<td align="left">CD15 FITC+CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">1</td>
<td align="right">11</td>
<td align="left">s5a03+CD15 FITCposCD45 PEneg+GO-QCEUS35</td>
<td align="right">9.0909091</td>
<td align="right">2.4116908</td>
<td align="left">s5a03+CD15 FITC+CD45 PE-</td>
<td align="left">5</td>
<td align="left">3</td>
<td align="left">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">s5a03</td>
<td align="left">CD15 FITC-CD45 PE-</td>
<td align="left">rectangle</td>
<td align="right">3</td>
<td align="right">11</td>
<td align="left">s5a03+CD15 FITCnegCD45 PEneg+GO-QCEUS35</td>
<td align="right">27.2727273</td>
<td align="right">1.4129345</td>
<td align="left">s5a03+CD15 FITC-CD45 PE-</td>
<td align="left">5</td>
<td align="left">3</td>
<td align="left">6</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Finally, we build a <code>populationExpressionObj</code> from the <code>GatingSet</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PEO &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PEOFromGatingSet.html">PEOFromGatingSet</a></span>(gs, <span class="dt">samplePop =</span> <span class="dv">1000</span>)
PEO</code></pre></div>
<pre><code>## &lt;populationExpressionObj&gt;
##   Inherits from: &lt;commonDataObj&gt;
##   Public:
##     annotation: data.table, data.frame
##     annotCols: Patient Visit Days Grade
##     checkIntegrity: function (reconcile = FALSE) 
##     clone: function (deep = FALSE) 
##     contextID: NULL
##     countPopulations: function () 
##     expressionData: data.table, data.frame
##     initialize: function (annotation, expressionData, mapVar = NULL, checkIntegrity = TRUE, 
##     mapVar: name
##     markers: FSC-Height SSC-Height CD15 FITC CD45 PE CD14 PerCP FL2-A ...
##     objId: PEO-PLVHZ87
##     populations: rectangle CD15 FITC-CD45 PE+ CD15 FITC+CD45 PE+ CD15 FIT ...
##     returnMergedData: function () 
##     setAnnotationDisplayOptions: function (annotCols) 
##     setMarkers: function (markers) 
##     setSubsetAndSortOptions: function (subsetOptions, sortOptions, checkIntegrity = TRUE) 
##     sortOptionList: NULL
##     sortOptions: Patient Visit Days Grade
##     subsetAnnotation: function (ids) 
##     subsetOptionList: list
##     subsetOptions: Patient Visit Days Grade</code></pre>
<p>We want to remove <code>Time</code> as a marker from PEO</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">markers &lt;-<span class="st"> </span><span class="kw">as.character</span>(PEO<span class="op">$</span>markers)
markers</code></pre></div>
<pre><code>## [1] "FSC-Height"        "SSC-Height"        "CD15 FITC"        
## [4] "CD45 PE"           "CD14 PerCP"        "FL2-A"            
## [7] "CD33 APC"          "Time (51.20 sec.)"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PEO<span class="op">$</span><span class="kw">setMarkers</span>(markers[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>])</code></pre></div>
<p>Viewing the merged data table from <code>PEO</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(PEO<span class="op">$</span><span class="kw">returnMergedData</span>()[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,])</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">cell</th>
<th align="left">idVar</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="left">Population</th>
<th align="left">Patient</th>
<th align="left">Visit</th>
<th align="left">Days</th>
<th align="right">Grade</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">371</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">236</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">269</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">259</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">232</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">201</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">240</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">380</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">206</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">213</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">276</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">217</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">239</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">232</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">211</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">226</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">247</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">229</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">264</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="left">s5a01</td>
<td align="left">FSC-Height</td>
<td align="right">205</td>
<td align="left">rectangle</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="left">-6</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Save all objects into a new Rda:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(PEO, GO, QCO, <span class="dt">file=</span><span class="st">"../sampleDashboard/data/GvHD.rda"</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#creating-a-gatingset-from-gvhd-data">Creating a GatingSet from GvHD Data</a></li>
      <li><a href="#building-data-objects">Building Data Objects</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ted Laderas G..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
